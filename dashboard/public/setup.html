<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bot Setup</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #eee; text-align: center; padding: 30px; }
    .card { background: #1c1c1c; padding: 20px; border-radius: 10px; display: inline-block; margin-top: 20px; }
    .guild { margin: 10px 0; padding: 10px; background: #222; border-radius: 8px; }
    .error { color: #ff4c4c; }
  </style>
</head>
<body>
  <h1>ü§ñ Bot Setup</h1>
  <div id="status">Loading setup info...</div>

  <div class="card" id="bot-info" style="display:none;">
    <h2 id="bot-tag"></h2>
    <p>ID: <span id="bot-id"></span></p>
  </div>

  <div class="card" id="guild-info" style="display:none;">
    <h3 id="guild-name"></h3>
    <p>Guild ID: <span id="guild-id"></span></p>
  </div>

  <script>
    async function loadSetup() {
      const params = new URLSearchParams(window.location.search);
      const token = params.get('token');
      if (!token) {
        document.getElementById('status').innerText = '‚ùå Missing setup token.';
        return;
      }

      try {
        const res = await fetch(`/api/setup-info?token=${encodeURIComponent(token)}`);
        const data = await res.json();

        if (!res.ok || data.error) {
          document.getElementById('status').innerHTML = `<span class="error">‚ùå ${data.error || 'Failed to load setup info.'}</span>`;
          return;
        }

        document.getElementById('status').innerText = '‚úÖ Setup data loaded';
        document.getElementById('bot-info').style.display = 'block';
        document.getElementById('guild-info').style.display = 'block';

        document.getElementById('bot-tag').innerText = data.bot.tag;
        document.getElementById('bot-id').innerText = data.bot.id;
        document.getElementById('guild-name').innerText = data.guild.name;
        document.getElementById('guild-id').innerText = data.guild.id;

      } catch (e) {
        console.error('Failed to load setup info:', e);
        document.getElementById('status').innerHTML = '<span class="error">‚ùå Failed to load setup info.</span>';
      }
    }

    loadSetup();
  </script>
</body>
</html>
